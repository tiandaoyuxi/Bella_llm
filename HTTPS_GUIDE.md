# HTTPS访问指南

为了使用麦克风功能，现代浏览器要求网站必须通过HTTPS协议访问。本指南将帮助您设置和使用HTTPS访问贝拉。

## 已完成的准备工作

您已经成功生成了SSL证书：
- server.key - 私钥文件
- server.csr - 证书请求文件
- server.crt - 证书文件

这些文件已经放置在`certs`目录中。

## 启动HTTPS服务器

服务器已经配置为同时支持HTTP和HTTPS：
- HTTP服务器运行在端口3002
- HTTPS服务器运行在端口3003

启动服务器的命令：

```bash
node server.js
```

## 访问HTTPS版本

启动服务器后，您可以通过以下URL访问HTTPS版本：

```
https://localhost:3003
```

或者直接打开`index-https.html`文件。

## 浏览器安全警告

由于使用的是自签名证书，浏览器会显示安全警告。这是正常的，您可以：

1. 在Chrome中，点击"高级"，然后点击"继续前往localhost(不安全)"
2. 在Firefox中，点击"高级"，然后点击"接受风险并继续"
3. 在Edge中，点击"详细信息"，然后点击"继续前往网站(不推荐)"

## 允许麦克风访问

首次访问时，浏览器会请求麦克风权限，请点击"允许"以启用语音识别功能。

## 故障排除

如果遇到问题：

1. **证书错误**：确保证书文件位于正确的位置（certs目录）
2. **端口被占用**：如果3003端口被占用，可以修改`server.js`中的`httpsPort`变量
3. **麦克风不工作**：
   - 确保使用的是HTTPS版本
   - 检查浏览器是否已授予麦克风权限
   - 尝试使用Chrome浏览器，它对Web Speech API的支持最好

## 在本地信任证书（可选）

为了避免浏览器警告，您可以将自签名证书添加到系统的受信任证书存储中：

### Windows

1. 双击`server.crt`文件
2. 点击"安装证书"
3. 选择"本地计算机"
4. 选择"将所有证书放入下列存储"，然后点击"浏览"
5. 选择"受信任的根证书颁发机构"，然后点击"确定"
6. 完成安装向导

### macOS

1. 双击`server.crt`文件，它会被添加到钥匙串访问
2. 打开钥匙串访问，找到证书（搜索"bella"）
3. 双击证书，展开"信任"部分
4. 将"使用此证书时"设置为"始终信任"
5. 关闭窗口，输入管理员密码确认更改

## 注意事项

- 自签名证书仅适用于开发和测试环境
- 证书有效期为365天，到期后需要重新生成
- 在生产环境中，应使用由受信任的证书颁发机构签发的证书